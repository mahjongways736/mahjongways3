<!-- Tambahkan Firebase SDK -->
<script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-database-compat.js"></script>
<script>
  const firebaseConfig = {
    apiKey: "AIzaSyAThDmthe18wYK8uTKS6rdp1V6yGmzSHds",
    authDomain: "slotmahjong-92afb.firebaseapp.com",
    databaseURL: "https://slotmahjong-92afb-default-rtdb.firebaseio.com",
    projectId: "slotmahjong-92afb",
    storageBucket: "slotmahjong-92afb.appspot.com",
    messagingSenderId: "700849730294",
    appId: "1:700849730294:web:17736d11c28b4d381132d7"
  };
  const app = firebase.initializeApp(firebaseConfig);
  const database = firebase.database();
</script>

<script>
  function encodeUsername(username) {
    return btoa(username.toLowerCase().trim());
  }

  function login() {
    const username = document.getElementById("username").value.trim();
    if (!username) {
      alert("Masukkan username!");
      return;
    }

    const encoded = encodeUsername(username);
    localStorage.setItem("mahjong_user", encoded); // simpan encoded username

    // Cek apakah user sudah ada
    const userRef = database.ref("players/" + encoded);
    userRef.get().then(snapshot => {
      if (!snapshot.exists()) {
        // Buat user baru jika belum ada
        userRef.set({
          nama: username,
          saldo: 100000
        });
      }
      window.location.href = "slot.html";
    });
  }
</script>
